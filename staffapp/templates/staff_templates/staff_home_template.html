{% extends 'staff_templates/base_template.html' %}

{% block page_title %}
    Staff Home
{% endblock page_title %}

{% block main_content %}

{% load static %}

<section class="content">
        <div class="container-fluid">

            {% comment %} Boxes Section Starts {% endcomment %}
            <div class="row">
                <div class="col-lg-3 col-6">
                    <!-- small box -->
                    <div class="small-box bg-info">
                    <div class="inner">
                        <h3>{{ students_count }}</h3>

                        <p>Students Under Me</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-stats-bars"></i>
                    </div>
                    <a href="#" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                    </div>
                </div>
                <!-- ./col -->
                <div class="col-lg-3 col-6">
                    <!-- small box -->
                    <div class="small-box bg-success">
                    <div class="inner">
                        <h3> {{ attendance_count }} </h3>

                        <p>Total Attendance Taken</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-stats-bars"></i>
                    </div>
                    <a href="#" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                    </div>
                </div>
                <!-- ./col -->
                <div class="col-lg-3 col-6">
                    <!-- small box -->
                    <div class="small-box bg-warning">
                    <div class="inner">
                        <h3>0</h3>

                        <p>Total Leave Taken</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-stats-bars"></i>
                    </div>
                    <a href="#" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                    </div>
                </div>
                <!-- ./col -->
                <div class="col-lg-3 col-6">
                    <!-- small box -->
                    <div class="small-box bg-danger">
                    <div class="inner">
                        <h3>{{ subjects_assigned_count}}</h3>

                        <p>Total Subjects</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-pie-graph"></i>
                    </div>
                    <a href="#" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                    </div>
                </div>
                <!-- ./col -->
                </div>
            {% comment %} Boxes Section Ends {% endcomment %}

            <div class="row">
                <div class="col-lg-6">
                    <!-- PIE CHART -->
                    <div class="card card-danger">
                    <div class="card-header">
                        <h3 class="card-title">Leave Status Chart</h3>

                        <div class="card-tools">
                        <button type="button" class="btn btn-tool" data-card-widget="collapse"><i class="fas fa-minus"></i>
                        </button>
                        <button type="button" class="btn btn-tool" data-card-widget="remove"><i class="fas fa-times"></i></button>
                        </div>
                    </div>
                    <div class="card-body">
                        <canvas id="pieChart" style="min-height: 250px; height: 250px; max-height: 250px; max-width: 100%;"></canvas>
                    </div>
                    <!-- /.card-body -->
                    </div>
                    <!-- /.card -->
                </div>

                <div class="col-lg-6">
                    <!-- BAR CHART -->
                    <div class="card card-success">
                    <div class="card-header">
                        <h3 class="card-title">Subjects Attend Chart</h3>

                        <div class="card-tools">
                        <button type="button" class="btn btn-tool" data-card-widget="collapse"><i class="fas fa-minus"></i>
                        </button>
                        <button type="button" class="btn btn-tool" data-card-widget="remove"><i class="fas fa-times"></i></button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="chart">
                        <canvas id="barChart" style="min-height: 250px; height: 250px; max-height: 250px; max-width: 100%;"></canvas>
                        </div>
                    </div>
                    <!-- /.card-body -->
                    </div>
                    <!-- /.card -->
                </div>
            </div>

            <div class="row">
                <div class="col-lg-12">
                    <!-- BAR CHART -->
                    <div class="card card-info">
                    <div class="card-header">
                        <h3 class="card-title">Student Attendance Data</h3>

                        <div class="card-tools">
                        <button type="button" class="btn btn-tool" data-card-widget="collapse"><i class="fas fa-minus"></i>
                        </button>
                        <button type="button" class="btn btn-tool" data-card-widget="remove"><i class="fas fa-times"></i></button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="chart">
                        <canvas id="barChart2" style="min-height: 250px; height: 250px; max-height: 250px; max-width: 100%;"></canvas>
                        </div>
                    </div>
                    <!-- /.card-body -->
                    </div>
                    <!-- /.card -->
                </div>
            </div>

        </div><!-- /.container-fluid -->
      </section>

  {% endblock main_content %}

  {% block custom_js %}
  <script src="{% static 'apexcharts/dist/apexcharts.min.js' %}"></script>
  <script>
      document.addEventListener('DOMContentLoaded', function () {
          // Sample data for the charts
          var staff_count = {{ staff_count }};
          var student_count = {{ student_count }};
  
          // Pie Chart for Staff vs Students
          var options1 = {
              series: [staff_count, student_count],
              chart: {
                  height: 350,
                  type: 'pie'
              },
              labels: ['Staff', 'Students'],
              title: {
                  text: 'Staff vs Students',
                  align: 'left'
              }
          };
  
          var chart1 = new ApexCharts(document.querySelector("#pieChart"), options1);
          chart1.render();
  
          // Sample data for total subjects in each course
          var courseSubjectCounts = [
              { course_name: 'Course 1', subject_count: 5 },
              { course_name: 'Course 2', subject_count: 7 },
              { course_name: 'Course 3', subject_count: 3 },
              { course_name: 'Course 4', subject_count: 6 },
              { course_name: 'Course 5', subject_count: 8 }
          ];
  
          var series2 = courseSubjectCounts.map(function (item) {
              return item.subject_count;
          });
  
          var labels2 = courseSubjectCounts.map(function (item) {
              return item.course_name;
          });
  
          // Pie Chart for Total Subjects in Each Course
          var options2 = {
              series: series2,
              chart: {
                  height: 350,
                  type: 'pie'
              },
              labels: labels2,
              title: {
                  text: 'Total Subjects per Course',
                  align: 'left'
              }
          };
  
          var chart2 = new ApexCharts(document.querySelector("#pieChart2"), options2);
          chart2.render();
  
          // Sample data for students in each course
          var courseStudentCounts = [
              { course_name: 'Course 1', student_count: 15 },
              { course_name: 'Course 2', student_count: 25 },
              { course_name: 'Course 3', student_count: 35 },
              { course_name: 'Course 4', student_count: 45 },
              { course_name: 'Course 5', student_count: 55 }
          ];
  
          var series3 = courseStudentCounts.map(function (item) {
              return item.student_count;
          });
  
          var labels3 = courseStudentCounts.map(function (item) {
              return item.course_name;
          });
  
          // Pie Chart for Total Students in Each Course
          var options3 = {
              series: series3,
              chart: {
                  height: 350,
                  type: 'pie'
              },
              labels: labels3,
              title: {
                  text: 'Total Students per Course',
                  align: 'left'
              }
          };
  
          var chart3 = new ApexCharts(document.querySelector("#pieChart3"), options3);
          chart3.render();
  
          // Sample data for students in each subject
          var subjectStudentCounts = [
              { subject_name: 'Subject 1', student_count: 10 },
              { subject_name: 'Subject 2', student_count: 20 },
              { subject_name: 'Subject 3', student_count: 30 },
              { subject_name: 'Subject 4', student_count: 40 },
              { subject_name: 'Subject 5', student_count: 50 }
          ];
  
          var series4 = subjectStudentCounts.map(function (item) {
              return item.student_count;
          });
  
          var labels4 = subjectStudentCounts.map(function (item) {
              return item.subject_name;
          });
  
          // Pie Chart for Total Students in Each Subject
          var options4 = {
              series: series4,
              chart: {
                  height: 350,
                  type: 'pie'
              },
              labels: labels4,
              title: {
                  text: 'Total Students per Subject',
                  align: 'left'
              }
          };
  
          var chart4 = new ApexCharts(document.querySelector("#pieChart4"), options4);
          chart4.render();
      });
  </script>
  {% endblock custom_js %}
  